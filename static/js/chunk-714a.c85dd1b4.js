(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-714a"],{"214f":function(t,e,a){"use strict";var s=a("32e9"),i=a("2aba"),n=a("79e5"),o=a("be13"),l=a("2b4c");t.exports=function(t,e,a){var r=l(t),c=a(o,r,""[t]),d=c[0],_=c[1];n(function(){var e={};return e[r]=function(){return 7},7!=""[t](e)})&&(i(String.prototype,t,d),s(RegExp.prototype,r,2==e?function(t,e){return _.call(t,this,e)}:function(t){return _.call(t,this)}))}},"28a5":function(t,e,a){a("214f")("split",2,function(t,e,s){"use strict";var i=a("aae3"),n=s,o=[].push,l="split",r="length",c="lastIndex";if("c"=="abbc"[l](/(b)*/)[1]||4!="test"[l](/(?:)/,-1)[r]||2!="ab"[l](/(?:ab)*/)[r]||4!="."[l](/(.?)(.?)/)[r]||"."[l](/()()/)[r]>1||""[l](/.?/)[r]){var d=void 0===/()??/.exec("")[1];s=function(t,e){var a=String(this);if(void 0===t&&0===e)return[];if(!i(t))return n.call(a,t,e);var s,l,_,u,p,m=[],f=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),v=0,h=void 0===e?4294967295:e>>>0,g=new RegExp(t.source,f+"g");d||(s=new RegExp("^"+g.source+"$(?!\\s)",f));while(l=g.exec(a)){if(_=l.index+l[0][r],_>v&&(m.push(a.slice(v,l.index)),!d&&l[r]>1&&l[0].replace(s,function(){for(p=1;p<arguments[r]-2;p++)void 0===arguments[p]&&(l[p]=void 0)}),l[r]>1&&l.index<a[r]&&o.apply(m,l.slice(1)),u=l[0][r],v=_,m[r]>=h))break;g[c]===l.index&&g[c]++}return v===a[r]?!u&&g.test("")||m.push(""):m.push(a.slice(v)),m[r]>h?m.slice(0,h):m}}else"0"[l](void 0,0)[r]&&(s=function(t,e){return void 0===t&&0===e?[]:n.call(this,t,e)});return[function(a,i){var n=t(this),o=void 0==a?void 0:a[e];return void 0!==o?o.call(a,n,i):s.call(String(n),a,i)},s]})},"51b8":function(t,e,a){"use strict";var s=a("c70f"),i=a.n(s);i.a},"94c1":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{overflow:"hidden"}},[a("div",{staticClass:"dy-info"},[t.move_data.movieInfo?a("div",{staticClass:"dy-info-name"},[t._v(t._s(t.move_data.movieInfo[0].movieName))]):t._e(),t.move_data.movieInfo?a("div",{staticClass:"dy-info-time"},[t._v(t._s(t.move_data.startTime)+" "+t._s(t.move_data.movieInfo[0].movieLanguage)+t._s(t.move_data.movieInfo[0].movieDimensional))]):t._e()]),a("section",{staticClass:"hidden",staticStyle:{display:"block"},attrs:{id:"seats"}},[a("div",{class:t.standard,attrs:{"data-user":""}},[a("div",{staticClass:"screen-center-name"},[a("div",{staticClass:"tixing"}),a("p",[t._v(t._s(t.move_data.hallName))])]),a("div",{attrs:{id:"wrapper"}},[a("div",{attrs:{id:"scroller"}},[a("div",{staticClass:"item"},[t._m(0),t._l(t.seat_data.rows,function(e,s){return a("p",{attrs:{id:"seat_scroll"}},[t._l(e.seats,function(e,s){return[0==e.seatState||1==e.seatState||2==e.seatState||6==e.seatState||8==e.seatState?a("a",{staticClass:"seat disabled",attrs:{href:"javascript:"}}):4==e.seatState?a("a",{staticClass:"seat active",attrs:{href:"javascript:",name:e.seatRow+"-"+e.seatCol},on:{click:function(a){t.seatnum(e.cineSeatId,e.seatRow,e.seatCol,e.graphCol)}}}):a("span",{staticClass:"seat"})]})],2)})],2)]),a("div",{staticClass:"side"},[a("ol",{attrs:{id:"float-row"}},[a("li",{staticClass:"cs"}),t._l(t.seat_data.rows,function(e,s){return a("li",[t._v("\n                                "+t._s(e.row)+"\n                            ")])}),a("li",{staticClass:"cs"})],2)])]),t._m(1)])]),a("div",{staticClass:"side-box"},t._l(t.select_seat,function(e){return a("div",{staticClass:"side-box-list"},[t._v(t._s(e.row)+"排"+t._s(e.col)+"座")])})),t.tip_msg?a("div",{staticClass:"js_dialog",attrs:{id:"iosDialog2"}},[a("div",{staticClass:"weui-mask"}),a("div",{staticClass:"weui-dialog"},[a("div",{staticClass:"weui-dialog__bd"},[t._v(t._s(t.tip_msg))]),a("div",{staticClass:"weui-dialog__ft"},[a("a",{staticClass:"weui-dialog__btn weui-dialog__btn_primary",attrs:{href:"javascript:;"},on:{click:function(e){t.tip_msg=""}}},[t._v("知道了")])])])]):t._e(),a("div",{staticClass:"dy-card-item"},[a("div",{staticClass:"dy-btn"},[t.select_seat.length?a("button",{staticClass:"dy-button",attrs:{id:"J_confirm",type:"submit"},on:{click:t.makeorder}},[t._v("确认选座")]):t._e(),t.select_seat.length?t._e():a("button",{staticClass:"dy-button",staticStyle:{border:"1px solid #9ad499",background:"#9de59c"},attrs:{id:"J_confirm",type:"submit"}},[t._v("请先选座")])])]),t.loading?a("div",{attrs:{id:"loadingToast"}},[a("div",{staticClass:"weui-mask_transparent"}),t._m(2)]):t._e(),t.hint?a("div",{attrs:{id:"loadingToast"}},[a("div",{staticClass:"weui-mask_transparent"}),a("div",{staticClass:"weui-toast"},[a("i",{staticClass:"weui-loading weui-icon_toast"}),a("p",{staticClass:"weui-toast__content"},[t._v(t._s(t.loginhint))])])]):t._e(),t.city_tip?a("div",{staticClass:"js_dialog",attrs:{id:"iosDialog1"}},[a("div",{staticClass:"weui-mask"}),a("div",{staticClass:"weui-dialog"},[a("div",{staticClass:"weui-dialog__bd"},[t._v("当前场次您有"+t._s(t.order_obj.buy_num)+"个座位的未支付订单")]),a("div",{staticClass:"weui-dialog__ft"},[a("a",{staticClass:"weui-dialog__btn weui-dialog__btn_primary",attrs:{href:"javascript:;"},on:{click:t.gopay}},[t._v("立即支付")]),a("a",{staticClass:"weui-dialog__btn weui-dialog__btn_default",attrs:{href:"javascript:;"},on:{click:t.nopay}},[t._v("我要重选")])])])]):t._e()])},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"c-tips"},[a("span",[t._v("银幕中央")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tips cf"},[a("ul",{staticClass:"seat-intro",staticStyle:{width:"100%"}},[a("li",[a("a",{staticClass:"seat active",attrs:{href:"javascript:;"}}),t._v("可选")]),a("li",[a("a",{staticClass:"seat disabled",attrs:{href:"javascript:;"}}),t._v("已售")]),a("li",[a("a",{staticClass:"seat selected",attrs:{href:"javascript:;"}}),t._v("已选")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"weui-toast"},[a("i",{staticClass:"weui-loading weui-icon_toast"}),a("p",{staticClass:"weui-toast__content"},[t._v("正在加载")])])}],n=(a("28a5"),a("a322")),o=a("a78e"),l=a.n(o),r={data:function(){var t;return t={loading:!0,tip_msg:!1,city_tip:!1,hint:!1,max:4,show_body:"none",standard:"main main-small main-big",seat_data:{},select_seat_meta:{},select_seat:"",order_obj:{},move_data:{},apid:"",codesrc:""},Object(n["a"])(t,"hint",""),Object(n["a"])(t,"apid",""),Object(n["a"])(t,"loginhint",""),Object(n["a"])(t,"identifying_code","发送验证码"),Object(n["a"])(t,"num",""),Object(n["a"])(t,"rowsLength",""),Object(n["a"])(t,"positionLeft","0"),Object(n["a"])(t,"zoom",""),Object(n["a"])(t,"loadScroll",null),Object(n["a"])(t,"tip_msg",""),Object(n["a"])(t,"cinemaId",""),Object(n["a"])(t,"plan_date",""),Object(n["a"])(t,"hallId",""),Object(n["a"])(t,"lastUpdateTime",""),Object(n["a"])(t,"planId",""),Object(n["a"])(t,"myScroll",""),Object(n["a"])(t,"code",""),t},beforeRouteEnter:function(t,e,a){document.title="在线选座",a()},created:function(){this.planId=this.$route.params.planId,this.lastUpdateTime=this.$route.params.lastUpdateTime,this.hallId=this.$route.params.hallId,this.cinemaId=this.$route.params.cinemaId,this.plan_date=this.$route.params.plan_date,this.fetchSeatData(this.plan_date,this.planId,this.lastUpdateTime,this.hallId,this.cinemaId)},mounted:function(){this.seatScroll()},beforeDestroy:function(){this.loadScroll&&clearInterval(this.loadScroll)},methods:{seatScroll:function(){var t=new IScroll("#wrapper",{scrollX:!0,scrollY:!0,preventDefault:!1,zoom:!0,zoomMax:1.5,zoomMin:1,bounce:!0,mouseWheel:!0,wheelAction:"zoom"});this.myScroll=t},back:function(){router.go(-1)},fetchSeatData:function(t,e,a,s,i){var n=this,o=this,r=l.a.get("_lac_ap_"),c="/general_api/api/GetSeats?plan_date="+t+"&plan_id="+e+"&last_update_time="+a+"&hall_id="+s+"&cinema_id="+i+"&ap_id="+r+"&"+Date.parse(new Date);fetch(c).then(function(t){return t.json()}).then(function(t){o.loading=!1,o.show_body="";var e=t.data.recent_order;0==t.code&&(o.move_data=t.data.plan,console.log(o.move_data),o.seat_data=t.data.seat,o.rowsLength=t.data.seat.rows.length),t.data.seat.rows.length>11&&(o.standard="main main-small"),e&&(n.city_tip=!0,n.order_obj=e);var a=setInterval(function(){if($("#wrapper")[0]){var t=$("#scroller").width(),e=$(window).width();$("#wrapper").animate({scrollLeft:(t-e)/2+22}),o.loadScroll=setInterval(function(){if($("#scroller").css("transform")){var t=$("#scroller").css("transform").split(","),e=parseFloat(t[5]),a="translateY("+e+"px) scale("+t[3]+")";$(".side").css("transform",a)}$(".side").css("left",$("#wrapper").scrollLeft())},1e3/60),clearInterval(a)}},300)})},gopay:function(){this.order_obj;var t=l.a.get("ticket_trdnum");location.href="/general_api/tcss/index/?#/confirmOrder/"+t},nopay:function(){var t=this,e=this.order_obj,a=l.a.get("_lac_k_"),s="/general_api/api/auth/release_seat_order?order_no="+e.order_no+"&token="+a+"&"+(new Date).getTime();this.loading=!0,this.city_tip=!1,fetch(s).then(function(t){return t.json()}).then(function(e){console.log(e),t.loading=!1,t.loading=!1,t.city_tip=!1,t.planId=t.$route.params.planId,t.lastUpdateTime=t.$route.params.lastUpdateTime,t.hallId=t.$route.params.hallId,t.cinemaId=t.$route.params.cinemaId,t.plan_date=t.$route.params.plan_date,t.fetchSeatData(t.plan_date,t.planId,t.lastUpdateTime,t.hallId,t.cinemaId)})},showTip:function(t,e){var a=this;a.tip_msg=t,e&&(clearTimeout(window.maxtm),window.maxtm=setTimeout(function(){a.tip_msg=""},e))},seatnum:function(t,e,a,s){var i=this,n=e+"-"+a;if(i.seats=n,i.select_seat_meta[n])delete i.select_seat_meta[n],$("a[name="+n+"]").removeClass("selected").addClass("active");else{if(i.select_seat.length+1>i.max)return void i.showTip("最多只能购买4个座位",1300);i.select_seat_meta[n]={sid:t,row:e,col:a},$("a[name="+n+"]").removeClass("active").addClass("selected")}var o=[];for(var l in i.select_seat_meta)o.push(i.select_seat_meta[l]);i.select_seat=o;o.length;var r=$("#seat_scroll .selected");r.offset()&&(i.rowsLength>11?(this.myScroll.zoom(1.5,r.offset().left,r.offset().top),this.myScroll.scrollToElement("#seat_scroll .selected",1200,!0,!0)):(this.myScroll.zoom(1.2,r.offset().left,r.offset().top),this.myScroll.scrollToElement("#seat_scroll .selected",1200,!0,!0)))},makeorder:function(){var t=this,e=l.a.get("_lac_k_"),a=(l.a.get("_lac_ated_"),l.a.get("_lac_op_"),l.a.get("_lac_ap_"));e?t.GoPayTicket():this.$router.push({name:"login",params:{apid:a}})},GoPayTicket:function(){var t=this;if(t.loading=!0,!t.select_seat.length)return t.showTip("请选择您要购买的座位",1300),void(t.loading=!1);for(var e="",a="",s=0,i=t.select_seat.length;s<i;s++)a&&(a+=","),a+=t.select_seat[s].sid,e=e+t.select_seat[s].row+"排"+t.select_seat[s].col+"座 ";var n=l.a.get("_lac_k_"),o="/general_api/api/auth/CreateSeatsOrder?plan_id="+t.planId+"&last_update_time="+t.lastUpdateTime+"&hall_id="+t.hallId+"&cinema_id="+t.cinemaId+"&seat_ids="+a+"&plan_date="+t.plan_date+"&token="+n+"&ts="+Date.parse(new Date);fetch(o).then(function(t){return t.json()}).then(function(e){if(t.loading=!1,0==e.code)document.cookie="orderNo="+e.data[1].order_no+";path=/",l.a.set("ticket_trdnum",e.data[0]),location.href="/general_api/tcss/index/?#/confirmOrder/"+e.data[0];else{if(0==e.available&&"user_no_login"==e.messages[0])return void(location.href="/general_api/h5/wx/auth?type=base&"+(new Date).getTime());t.showTip("座位锁定失败",1300),t.seat_data={},t.select_seat_meta=[],t.select_seat=[],t.fetchSeatData(t.plan_date,t.planId,t.lastUpdateTime,t.hallId,t.cinemaId)}})}}},c=r,d=(a("51b8"),a("2877")),_=Object(d["a"])(c,s,i,!1,null,null,null);e["default"]=_.exports},a78e:function(t,e,a){var s,i;
/*!
 * JavaScript Cookie v2.2.0
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */(function(n){var o=!1;if(s=n,i="function"===typeof s?s.call(e,a,e,t):s,void 0===i||(t.exports=i),o=!0,t.exports=n(),o=!0,!o){var l=window.Cookies,r=window.Cookies=n();r.noConflict=function(){return window.Cookies=l,r}}})(function(){function t(){for(var t=0,e={};t<arguments.length;t++){var a=arguments[t];for(var s in a)e[s]=a[s]}return e}function e(a){function s(e,i,n){var o;if("undefined"!==typeof document){if(arguments.length>1){if(n=t({path:"/"},s.defaults,n),"number"===typeof n.expires){var l=new Date;l.setMilliseconds(l.getMilliseconds()+864e5*n.expires),n.expires=l}n.expires=n.expires?n.expires.toUTCString():"";try{o=JSON.stringify(i),/^[\{\[]/.test(o)&&(i=o)}catch(t){}i=a.write?a.write(i,e):encodeURIComponent(String(i)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)),e=e.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),e=e.replace(/[\(\)]/g,escape);var r="";for(var c in n)n[c]&&(r+="; "+c,!0!==n[c]&&(r+="="+n[c]));return document.cookie=e+"="+i+r}e||(o={});for(var d=document.cookie?document.cookie.split("; "):[],_=/(%[0-9A-Z]{2})+/g,u=0;u<d.length;u++){var p=d[u].split("="),m=p.slice(1).join("=");this.json||'"'!==m.charAt(0)||(m=m.slice(1,-1));try{var f=p[0].replace(_,decodeURIComponent);if(m=a.read?a.read(m,f):a(m,f)||m.replace(_,decodeURIComponent),this.json)try{m=JSON.parse(m)}catch(t){}if(e===f){o=m;break}e||(o[f]=m)}catch(t){}}return o}}return s.set=s,s.get=function(t){return s.call(s,t)},s.getJSON=function(){return s.apply({json:!0},[].slice.call(arguments))},s.defaults={},s.remove=function(e,a){s(e,"",t(a,{expires:-1}))},s.withConverter=e,s}return e(function(){})})},aae3:function(t,e,a){var s=a("d3f4"),i=a("2d95"),n=a("2b4c")("match");t.exports=function(t){var e;return s(t)&&(void 0!==(e=t[n])?!!e:"RegExp"==i(t))}},c70f:function(t,e,a){}}]);