(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-059f"],{"5e72":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{background:"#EFEFF4"}},[i("div",{staticClass:"order-card-box"},[i("div",{staticClass:"order-card-con-bg"},[i("div",{staticClass:"order-card-con"},[i("div",{staticClass:"order-card-title"},[i("p",[i("span",{staticClass:"card-title-name"},[t._v(t._s(t.movieDetails.film_name)+" "),i("b",{staticClass:"card-title-sore"},[t._v(t._s(t.movieDetails.ticket_sum)+"张")])]),i("span",{staticClass:"card-title-right",staticStyle:{width:"1.6rem"}},[t._v("付款剩余时间")])])]),i("div",{staticClass:"card-title-right-time"},[t._v(t._s(t.msg))]),i("div",{staticClass:"order-card-time"},[i("p",[t._v(t._s(t.movieDetails.plan_date)+" "+t._s(t.movieDetails.plan_time))])]),i("div",{staticClass:"order-card-address"},[i("p",[t._v(t._s(t.movieDetails.store_name))])]),i("div",{staticClass:"order-card-seat"},[i("p",[t._v(t._s(t.movieDetails.hall_name)+" "),t._l(t.movieDetails.seats,function(e){return i("span",[t._v(" "+t._s(e.seat_sr)+"排"+t._s(e.seat_sc)+"座 ")])})],2)]),i("div",{staticClass:"dashed"}),t._m(0)])])]),i("section",{staticClass:"myweui-cells weui-cells",staticStyle:{"margin-top":".3rem"}},[i("a",{staticClass:"weui-cell myweui-cell cell-height-88 weui-cell_access",attrs:{href:"javascript:;"},on:{click:t.goCoupons}},[t._m(1),t.o_c?i("div",{staticClass:"weui-cell__ft",staticStyle:{"font-size":".3rem"}},[t._v(t._s(t.o_c.batch_title))]):i("div",{staticClass:"weui-cell__ft",staticStyle:{"font-size":".3rem"}},[t._v("点击选择")])]),i("div",{staticClass:"weui-cell myweui-cell cell-height-88"},[t._m(2),i("div",{staticClass:"weui-cell__ft",staticStyle:{color:"#00c203","font-size":".3rem"}},[t._v(t._s(t.movieDetails.total_amount/100)+"元")])])]),"-1"==t.CardData||null==t.CardData?i("section",{staticClass:"vip-card"},[i("div",{staticClass:"weui-cells myweui-cells",staticStyle:{"margin-top":".3rem"},on:{click:t.GoKaika}},[i("a",{staticClass:"weui-cell myweui-cell vip-cell weui-cell_access",attrs:{href:"javascript:;"}},[i("div",{staticClass:"weui-cell__bd"},[i("div"),i("p",{staticClass:"vip-cell-title",staticStyle:{"font-size":".3rem"}},[t._v(t._s(t.logo.proj_name)+"会员卡")]),t._m(3)]),i("div",{staticClass:"weui-cell__ft"})])])]):i("section",{staticClass:"myweui-cells weui-cells_checkbox",staticStyle:{"margin-top":".3rem"}},[t.CardData?i("label",{staticClass:"weui-cell myweui-cell cell-height-88 weui-check__label",staticStyle:{background:"#fff"},attrs:{for:"x11"},on:{click:function(e){e.preventDefault(),t.changePrice("101001")}}},[i("div",{staticClass:"weui-cell__bd"},[i("p",[t._v("会员余额支付（余额："+t._s(t.CardData[0].balance/100)+"元）")])]),i("div",{staticClass:"weui-cell__ft"},[i("input",{staticClass:"weui-check",attrs:{type:"radio",name:"radio1",id:"x11"},domProps:{checked:"101001"===t.pay_methods}}),i("span",{staticClass:"weui-icon-checked",staticStyle:{transform:"scale(.8)"}})])]):t._e(),i("label",{staticClass:"weui-cell myweui-cell cell-height-88 weui-check__label",staticStyle:{background:"#fff"},attrs:{for:"x12"},on:{click:function(e){e.preventDefault(),t.changePrice("201101")}}},[t._m(4),i("div",{staticClass:"weui-cell__ft"},[i("input",{staticClass:"weui-check",attrs:{type:"radio",name:"radio1",id:"x12"},domProps:{checked:"201101"===t.pay_methods}}),i("span",{staticClass:"weui-icon-checked",staticStyle:{transform:"scale(.8)"}})])])]),i("div",{staticClass:"myweui-panel weui-panel weui-panel_access",staticStyle:{"padding-bottom":"2.5rem"}},[i("div",{staticClass:"weui-panel__hd",staticStyle:{color:"#000"}},[t._v("购票须知")]),i("div",{staticClass:"weui-panel__bd"},[i("div",{staticClass:"weui-media-box weui-media-box_text"},[i("p",{staticClass:"weui-media-box__desc myweui-media-box__desc"},[t._v("\n                    1、由于设备故障等不可抗力因素，存在少量场次取消的情况，会进行退票退款"),i("br"),t._v(" \n                    2、由于影院系统不稳定等因素，存在出票失败的情况，会进行退款"),i("br"),t._v(" \n                    3、取票码不再通过短信发送，可在“钱包-卡券”或“我的-电影票”中查看"),i("br"),t._v(" \n                    4、下单即代表你同意"),i("a",{staticStyle:{color:"#00c203"},attrs:{href:"javascript:void(0);"}},[t._v("《"+t._s(t.logo.proj_name)+"用户服务协议》")]),i("br"),t._v(" \n                    5、订单编号"+t._s(t.movieDetails.order_no)+"\n                ")])])])]),i("div",{staticClass:"confirm-btn-container",staticStyle:{position:"fixed",bottom:"0"}},[i("div",{staticClass:"btn-container"},[i("div",{staticClass:"confirm-btn-total-price",on:{click:t.isShow}},[i("p",[i("span",[t._v("合计:")]),i("span",{staticStyle:{color:"#00c203"}},[t._v(t._s(t.movieDetails.pay_amount/100)+"元")]),i("span",{staticClass:"iconfont icon-triangle-up",class:t.trangle?"trangle-down":"trangle-up",staticStyle:{"font-size":".26rem",color:"#BCBEC1"}})])]),i("div",{staticClass:"confirm-btn"},[i("a",{staticClass:"weui-btn weui-btn_primary",staticStyle:{"font-size":"0.34rem",color:"#fff"},attrs:{href:"javascript:;"},on:{click:t.GoPay}},[t._v("确认支付")])])]),i("div",{staticClass:"order-details-card",staticStyle:{display:"none"}},[i("div",{staticClass:"order-details-card-title"},[i("p",[t._v("结算明细")]),i("div",{staticClass:"cancel-card-show",on:{click:t.isShow}},[t._v("取消")])]),i("div",{staticClass:"order-details-card-con"},[t._m(5),i("div",{staticClass:"card-con-item"},[i("p",{staticClass:"color-a9"},[i("span",[t._v("原价票")]),i("span",[t._v(t._s(t.movieDetails.total_amount/t.movieDetails.ticket_sum/100)+"元 X "+t._s(t.movieDetails.ticket_sum))])]),t.offer_show?i("p",{staticClass:"color-a9"},[i("span",[t._v("优惠券")]),i("span",[t._v("减："+t._s(t.offer_amount)+"元")])]):t._e()])])])]),i("div",{staticClass:"weui-mask",staticStyle:{display:"none","z-index":"98"},attrs:{id:"iosMask"},on:{click:t.isShow}}),t.loading?i("div",{attrs:{id:"loadingToast"}},[i("div",{staticClass:"weui-mask_transparent"}),t._m(6)]):t._e(),t.tip_msg?i("div",{staticClass:"js_dialog",attrs:{id:"iosDialog2"}},[i("div",{staticClass:"weui-mask",staticStyle:{"z-index":"100"}}),i("div",{staticClass:"weui-dialog"},[i("div",{staticClass:"weui-dialog__bd"},[t._v(t._s(t.tip_msg))]),i("div",{staticClass:"weui-dialog__ft"},[i("a",{staticClass:"weui-dialog__btn weui-dialog__btn_primary",attrs:{href:"javascript:;"},on:{click:function(e){t.tip_msg=""}}},[t._v("知道了")])])])]):t._e(),t.Pwd_tip?i("div",{staticClass:"js_dialog",attrs:{id:"iosDialog1"}},[i("div",{staticClass:"weui-mask",staticStyle:{"z-index":"100"}}),i("div",{staticClass:"weui-dialog"},[i("div",{staticClass:"weui-dialog__bd"},[t._v("请输入会员卡密码")]),i("div",{staticClass:"weui-dialog__bd nified"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.Pwd,expression:"Pwd"}],staticStyle:{border:"1px solid #ccc",width:"70%",height:".6rem","margin-bottom":".3rem"},attrs:{type:"password",name:""},domProps:{value:t.Pwd},on:{input:function(e){e.target.composing||(t.Pwd=e.target.value)}}})]),i("div",{staticClass:"weui-dialog__ft"},[i("a",{staticClass:"weui-dialog__btn weui-dialog__btn_default",attrs:{href:"javascript:;"},on:{click:t.PwdTip}},[t._v("取消")]),i("a",{staticClass:"weui-dialog__btn weui-dialog__btn_primary",attrs:{href:"javascript:;"},on:{click:t.setPwd}},[t._v("确定")])])])]):t._e()])},s=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"order-card-status"},[i("div",{staticClass:"t-cancel"},[i("i",{staticClass:"iconfont icon-cancel"}),i("span",[t._v("不可退票")])]),i("div",{staticClass:"t-change"},[i("i",{staticClass:"iconfont icon-cancel"}),i("span",[t._v("不可改签")])])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"weui-cell__bd"},[i("p",{staticStyle:{"font-size":".3rem",color:"#2c3e50"}},[t._v("优惠券")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"weui-cell__bd"},[i("p",{staticStyle:{"font-size":".3rem"}},[t._v("票价总计")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("p",{staticClass:"vip-cell-con"},[t._v("开卡影票最低"),i("span",[t._v("25元起")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"weui-cell__bd"},[i("p",[t._v("微信支付")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"card-con-title"},[i("span",[t._v("电影票")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"weui-toast"},[i("i",{staticClass:"weui-loading weui-icon_toast"}),i("p",{staticClass:"weui-toast__content"},[t._v("加载中")])])}],n=(i("c5f6"),i("c93e")),o=i("a78e"),c=i.n(o),r=i("2f62"),l={data:function(){return{loading:!0,Pwd_tip:!1,on:"",movieDetails:"",CardData:"",trangle:!1,isFixed:!1,msg:"15:00",tnum:"",other:"",tip_msg:"",Pwd:"",order_no:"",o_c:"",offer_amount:"",offer_show:!1,pay_methods:"101001"}},beforeRouteEnter:function(t,e,i){document.title="确认订单",i()},created:function(){var t=sessionStorage.getItem("o_c");t&&(this.o_c=JSON.parse(t))},computed:Object(n["a"])({},Object(r["c"])(["logo"])),mounted:function(){this.on=c.a.get("orderNo"),this.tnum=this.$route.params.tnum,this.GetAccountCard(),this.GetOrderDetails(),this.countTime("900")},methods:{showTip:function(t,e){var i=this;i.tip_msg=t,e&&(clearTimeout(window.maxtm),window.maxtm=setTimeout(function(){i.tip_msg=""},e))},PwdTip:function(){var t=this;t.Pwd_tip=!1},GoPay:function(){var t=this,e=t.tnum;t.loading=!0;var i=c.a.get("_lac_k_");if("-1"==t.CardData||null==t.CardData){var a=t.o_c.id||"",s="/general_api/api/auth/GetWxObj?ct=201101&token="+i+"&tnum="+e+"&coupon_id="+a+"&ts="+Date.parse(new Date);fetch(s).then(function(t){return t.json()}).then(function(e){console.log(e),-1==e.code?(t.loading=!1,t.showTip(e.text)):0==e.code?(t.loading=!1,t.other=e.other,t.onBridgeReady()):0==e.available&&"user_no_login"==e.messages[0]&&t.showTip("用户未登录")})}else if(document.getElementById("x12").checked){var n=t.o_c.id||"";s="/general_api/api/auth/GetWxObj?ct=201101&token="+i+"&coupon_id="+n+"&tnum="+e+"&ts="+Date.parse(new Date);fetch(s).then(function(t){return t.json()}).then(function(e){console.log(e),-1==e.code?(t.loading=!1,t.showTip(e.text)):0==e.code?(t.loading=!1,t.other=e.other,t.onBridgeReady()):0==e.available&&"user_no_login"==e.messages[0]&&t.showTip("用户未登录")})}else t.loading=!1,t.Pwd_tip=!0},setPwd:function(){var t=this,e=c.a.get("_lac_k_"),i=t.tnum,a=t.o_c.id||"",s="/general_api/api/auth/GetWxObj?ct=101001&token="+e+"&coupon_id="+a+"&tnum="+i+"&pwd="+t.Pwd+"&unicode="+t.CardData[0].mc_num+"&ts="+Date.parse(new Date);t.loading=!0,t.Pwd_tip=!1,fetch(s).then(function(t){return t.json()}).then(function(e){t.loading=!1,"-1"==e.code?(t.showTip(e.text),t.Pwd_tip=!1,t.Pwd=""):"0"==e.code&&"交易成功"==e.text?(t.loading=!1,t.Pwd_tip=!1,t.showTip("支付成功"),t.Pwd="",setTimeout(function(){t.$router.push({name:"votingCode",params:{on:t.on}})},100)):"0"==e.code&&"-1"==e.other[0].code?(t.loading=!1,t.Pwd_tip=!1,t.showTip(e.other[0].err_code_desc),t.Pwd=""):0==e.available&&"user_no_login"==e.messages[0]?(t.Pwd_tip=!1,t.Pwd="",t.showTip("用户未登录")):0==e.available&&"trade_status_invalid"==e.messages[0]&&(t.Pwd_tip=!1,t.Pwd="",t.showTip("请勿重复支付"))})},onBridgeReady:function(){var t=this.other;WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:t.appId,timeStamp:t.timeStamp,nonceStr:t.nonceStr,package:t.package,signType:"MD5",paySign:t.paySign},function(t){"get_brand_wcpay_request:ok"==t.err_msg?location.href="/general_api/tcss/index#/myTicket":"get_brand_wcpay_request:cancel"==t.err_msg?alert("您取消了付款"):"get_brand_wcpay_request:fail"==t.err_msg&&alert("支付失败")})},GoKaika:function(){location.href="/general_api/tcss/index/?#/purchasingCard/purchasing"},countTime:function(t){var e=this;t=Number(t);if(t>=0){var i=Math.floor(t/60),a=Math.floor(t%60),s=i+":"+a;e.msg=s,setTimeout(function(){t-=1,e.countTime(t)},1e3)}else e.msg="00:00"},GetAccountCard:function(){var t=this,e=c.a.get("_lac_k_"),i="/general_api/api/auth/GetAccountCard?token="+e+"&ts="+Date.parse(new Date);fetch(i).then(function(t){return t.json()}).then(function(e){t.CardData=e.obj,t.loading=!1})},GetOrderDetails:function(){var t=this,e=this,i=this.o_c.id||"",a="/general_api/api/GetTicketOrderDetails?order_no="+e.on+"&coupon_id="+i+"&ts="+Date.parse(new Date);fetch(a).then(function(t){return t.json()}).then(function(i){0==i.code&&(e.movieDetails=i.data,e.order_no=i.data.order_no,e.loading=!1,null===i.pref_coupon?sessionStorage.removeItem("o_c"):""===i.pref_coupon?(weui.topTips("当前优惠券无法使用",5e3),sessionStorage.removeItem("o_c"),t.o_c=""):(e.offer_amount=i.pref_coupon.prep_amount/100,e.offer_show=!0))})},isShow:function(){this.trangle=!this.trangle;var t=$("#iosMask"),e=$(".order-details-card");this.trangle?(t.fadeIn(200),e.slideDown(400)):(t.fadeOut(200),e.slideUp(400))},goCoupons:function(){var t=this.order_no,e=this.tnum;this.$router.push({name:"couponsForOrder",params:{order_no:t,tnum:e}})},changePrice:function(t){var e=this;this.loading=!0,this.pay_methods=t;var i=this.CardData[0].card_code||"",a=this.o_c.id||"",s="/general_api/api/change_price?tnum="+this.tnum+"&order_no="+this.on+"&ct="+t+"&unicode="+i+"&coupons="+a+"&ts="+Date.parse(new Date);fetch(s).then(function(t){return t.json()}).then(function(t){e.loading=!1,console.log(t),0==t.code&&(e.movieDetails=t.data)}).catch(function(t){e.loading=!1})}}},d=l,_=(i("f9e9"),i("2877")),u=Object(_["a"])(d,a,s,!1,null,null,null);e["default"]=u.exports},7536:function(t,e,i){},a78e:function(t,e,i){var a,s;
/*!
 * JavaScript Cookie v2.2.0
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */(function(n){var o=!1;if(a=n,s="function"===typeof a?a.call(e,i,e,t):a,void 0===s||(t.exports=s),o=!0,t.exports=n(),o=!0,!o){var c=window.Cookies,r=window.Cookies=n();r.noConflict=function(){return window.Cookies=c,r}}})(function(){function t(){for(var t=0,e={};t<arguments.length;t++){var i=arguments[t];for(var a in i)e[a]=i[a]}return e}function e(i){function a(e,s,n){var o;if("undefined"!==typeof document){if(arguments.length>1){if(n=t({path:"/"},a.defaults,n),"number"===typeof n.expires){var c=new Date;c.setMilliseconds(c.getMilliseconds()+864e5*n.expires),n.expires=c}n.expires=n.expires?n.expires.toUTCString():"";try{o=JSON.stringify(s),/^[\{\[]/.test(o)&&(s=o)}catch(t){}s=i.write?i.write(s,e):encodeURIComponent(String(s)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)),e=e.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),e=e.replace(/[\(\)]/g,escape);var r="";for(var l in n)n[l]&&(r+="; "+l,!0!==n[l]&&(r+="="+n[l]));return document.cookie=e+"="+s+r}e||(o={});for(var d=document.cookie?document.cookie.split("; "):[],_=/(%[0-9A-Z]{2})+/g,u=0;u<d.length;u++){var p=d[u].split("="),m=p.slice(1).join("=");this.json||'"'!==m.charAt(0)||(m=m.slice(1,-1));try{var v=p[0].replace(_,decodeURIComponent);if(m=i.read?i.read(m,v):i(m,v)||m.replace(_,decodeURIComponent),this.json)try{m=JSON.parse(m)}catch(t){}if(e===v){o=m;break}e||(o[v]=m)}catch(t){}}return o}}return a.set=a,a.get=function(t){return a.call(a,t)},a.getJSON=function(){return a.apply({json:!0},[].slice.call(arguments))},a.defaults={},a.remove=function(e,i){a(e,"",t(i,{expires:-1}))},a.withConverter=e,a}return e(function(){})})},c93e:function(t,e,i){"use strict";i.d(e,"a",function(){return s});var a=i("a322");function s(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},s=Object.keys(i);"function"===typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),s.forEach(function(e){Object(a["a"])(t,e,i[e])})}return t}},f9e9:function(t,e,i){"use strict";var a=i("7536"),s=i.n(a);s.a}}]);